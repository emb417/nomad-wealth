{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"\ud83c\udfe0 Nomad Wealth Documentation","text":"<p>Welcome to the documentation for Nomad Wealth, a policy\u2011driven Monte Carlo simulation framework for financial planning. This documentation is designed to provide audit clarity, transparency, and strategic insight into every aspect of the system.</p>"},{"location":"#getting-started","title":"\ud83d\ude80 Getting Started","text":"<p>The best place to begin is the Framework Overview. It explains the purpose of Nomad Wealth, its design principles, and how the system fits together.</p>"},{"location":"#documentation-structure","title":"\ud83d\udcda Documentation Structure","text":"<ul> <li>Framework Overview \u2192 Conceptual landing page, purpose, workflow, design principles.</li> <li>Configuration Reference \u2192 JSON and CSV schemas for buckets, policies, and seed balances.</li> <li>Architecture Overview \u2192 Modular system design and data flow.</li> <li>Simulation Logic (<code>forecast_engine.py</code>) \u2192 Step\u2011by\u2011step execution of the monthly forecast loop and Monte Carlo trials.</li> <li>Visualization Guide (<code>visualizations.py</code>) \u2192 Interactive charts (historical, per\u2011trial, Monte Carlo) and CSV/HTML exports for audit clarity.</li> <li>Usage Guide \u2192 How to run simulations, control flags, and interpret outputs.</li> </ul> <p>Each section includes audit notes to ensure reproducibility and IRS\u2011aligned transparency.</p>"},{"location":"#design-philosophy","title":"\ud83c\udfaf Design Philosophy","text":"<p>Nomad Wealth is built around:</p> <ul> <li>Policy\u2011First \u2192 declarative JSON rules drive all behavior.</li> <li>Audit Clarity \u2192 every projection is traceable and reproducible.</li> <li>IRS Alignment \u2192 tax rules, penalties, and premiums modeled explicitly.</li> <li>Extensibility \u2192 modular design supports new transaction types, policies, and tax rules.</li> <li>Resilience \u2192 Monte Carlo sampling embraces volatility and quantifies sufficiency.</li> <li>Transparency &amp; Reproducibility \u2192 charts, CSV/HTML exports, and logging provide clear evidence for auditors and users alike.</li> </ul>"},{"location":"#next-steps","title":"\ud83d\udcda Next Steps","text":"<p>\ud83d\udc49 Start with the Framework Overview to understand the system\u2019s purpose and design. From there, follow the flow: Configuration \u2192 Architecture \u2192 Simulation \u2192 Visualization \u2192 Usage.</p>"},{"location":"architecture/","title":"\ud83c\udfdb\ufe0f Architecture Overview","text":"<p>Nomad Wealth is a policy-driven Monte Carlo simulation framework for financial planning. Its architecture is designed for audit clarity, transparency, and extensibility, ensuring that every projection, chart, and policy is IRS-aligned and defensible.</p>"},{"location":"architecture/#high-level-design","title":"\ud83d\udd0d High-Level Design","text":"<p>The system is organized into modular components under <code>src/</code>:</p> <ul> <li>Entry Point (<code>app.py</code>) \u2192 orchestrates configuration loading, staging, parallel execution, aggregation, and visualization.</li> <li>Forecast Engine (<code>forecast_engine.py</code>) \u2192 runs the monthly simulation loop, applying transactions, policies, market returns, and taxes.</li> <li>Buckets &amp; Holdings (<code>buckets.py</code>) \u2192 core data structures representing accounts, holdings, and asset classes.</li> <li>Policies (<code>policy_engine.py</code>, <code>policies_transactions.py</code>) \u2192 enforce refill rules, liquidation hierarchies, and penalty logic.</li> <li>Transactions (<code>rules_transactions.py</code>) \u2192 define fixed, recurring, salary, Social Security, Roth conversions, and other flows.</li> <li>Economic Factors (<code>economic_factors.py</code>) \u2192 simulate inflation and market returns using historical distributions.</li> <li>Taxes (<code>taxes.py</code>) \u2192 apply IRS-compliant tax rules for ordinary income, capital gains, and Social Security.</li> <li>Visualization (<code>visualizations.py</code>) \u2192 generate interactive charts (historical, per\u2011trial, Monte Carlo) and CSV/HTML exports for audit clarity.</li> <li>Helper Functions (<code>app.py</code>) \u2192 utilities for timing, inflation modifiers, and bucket creation.</li> </ul>"},{"location":"architecture/#data-flow","title":"\ud83d\udcc2 Data Flow","text":"<ol> <li> <p>Configuration Loading</p> </li> <li> <p>JSON files in <code>config/</code> define buckets, policies, tax brackets, and simulation parameters.</p> </li> <li> <p>CSV files in <code>data/</code> seed historical balances and define fixed/recurring transactions.</p> </li> <li> <p>Staging</p> </li> <li> <p><code>stage_load()</code> \u2192 loads JSON configs and CSV inputs.</p> <ul> <li>Inputs include:</li> <li><code>balances.csv</code> \u2192 seed balances.</li> <li><code>fixed.csv</code> \u2192 one\u2011time events.</li> <li><code>recurring.csv</code> \u2192 ongoing monthly flows.</li> <li>Policies (<code>policies.json</code>), tax brackets (<code>tax_brackets.json</code>), inflation (<code>inflation_rates.json</code> + thresholds + gain table), and marketplace premiums (<code>marketplace_premiums.json</code>) are also loaded.</li> </ul> </li> <li><code>stage_prepare_timeframes()</code> \u2192 builds historical (<code>hist_df</code>) and future (<code>future_df</code>) frames.</li> <li> <p><code>stage_init_components()</code> \u2192 seeds buckets, policies, inflation, tax calculator, market gains, and transactions.</p> <ul> <li>Helper functions ensure integrity:</li> <li><code>create_bucket()</code> \u2192 allocates balances across holdings, correcting rounding drift.</li> <li><code>seed_buckets_from_config()</code> \u2192 validates bucket definitions against historical balances.</li> <li><code>build_description_inflation_modifiers()</code> \u2192 applies inflation profiles consistently across categories.</li> <li><code>timed()</code> \u2192 logs performance metrics for reproducibility.</li> </ul> </li> <li> <p>Parallel Simulation Loop (Forecast Engine)</p> </li> <li> <p>Monte Carlo trials executed in parallel with <code>ProcessPoolExecutor</code>.</p> </li> <li>Each trial applies monthly transactions, refill policies, market returns, and taxes.</li> <li> <p>FlowTracker records all debits/credits for audit clarity.</p> </li> <li> <p>Aggregation &amp; Summary</p> </li> <li> <p>Trial results aggregated into DataFrames for net worth, taxes, taxable balances, and monthly returns.</p> </li> <li>Property liquidation events tracked across simulations.</li> <li> <p>Taxable balances at SEPP end month recorded for compliance checks.</p> </li> <li> <p>Visualization Layer</p> </li> <li>Per-trial charts: monthly expenses, transactions, taxes, forecasts.</li> <li>Aggregate Monte Carlo charts: monthly returns, taxable balances, totals/rates, net worth distribution.</li> <li>Historical charts: bucket gains and net worth trajectory.</li> <li>All charts exportable to HTML and CSV for reproducibility.</li> </ol>"},{"location":"architecture/#irs-compliance","title":"\ud83e\uddfe IRS Compliance","text":"<p>The tax engine enforces IRS rules with explicit, layered logic:</p> <ul> <li>Ordinary income brackets inflated annually.</li> <li>Capital gains layered above ordinary income.</li> <li>Social Security capped at 85% of provisional income.</li> <li>Penalty tax applied only when flagged in metadata.</li> <li>AGI includes salary, withdrawals, conversions, gains, and Social Security.</li> <li>Taxable income calculated after deductions.</li> <li>Inflation modeled stochastically, anchored to a base year.</li> </ul>"},{"location":"architecture/#visualization-integration","title":"\ud83d\udcca Visualization Integration","text":"<p>Visualization is embedded in the simulation loop:</p> <ul> <li>Historical context \u2192 charts of bucket gains and net worth trends.</li> <li>Per-trial transparency \u2192 expenses, transactions, taxes, forecasts.</li> <li>Aggregate clarity \u2192 distributions of returns, balances, taxes, and net worth across Monte Carlo trials.</li> <li>Audit reproducibility \u2192 all charts exportable to HTML/CSV with timestamped filenames, with consistent color palettes, percentile overlays, and hover text for interpretability.</li> </ul>"},{"location":"architecture/#design-principles","title":"\ud83c\udfaf Design Principles","text":"<ul> <li>Policy-First \u2192 all financial rules are declarative JSON, transparent and repeatable.</li> <li>Audit Clarity \u2192 every dollar is traceable across buckets and scenarios.</li> <li>Extensibility \u2192 modular design allows new transaction types, policies, or tax rules.</li> <li>Resilience \u2192 Monte Carlo sampling embraces volatility, quantifying sufficiency and optimization.</li> <li>Parallelism \u2192 simulations scale efficiently with <code>ProcessPoolExecutor</code>.</li> <li>Integrity \u2192 helper functions enforce balance correctness, inflation consistency, and reproducible timing.</li> </ul>"},{"location":"architecture/#related-pages","title":"\ud83d\udcda Related Pages","text":"<ul> <li>Framework Overview</li> <li>Configuration Reference</li> <li>Simulation Logic</li> <li>Visualization Guide</li> <li>Usage Guide</li> </ul>"},{"location":"configuration/","title":"\u2699\ufe0f Configuration Reference","text":"<p>Nomad Wealth is policy\u2011first: all simulation behavior is driven by declarative configuration files. This page documents the JSON and CSV schemas that define buckets, policies, tax brackets, seed balances, and transactions.</p>"},{"location":"configuration/#getting-started-basic-vs-recommended-vs-advanced","title":"\ud83d\udd11 Getting Started: Basic vs. Recommended vs. Advanced","text":""},{"location":"configuration/#basic","title":"BASIC","text":"<p>To run a personalized simulation, you should revise these files:</p> <ul> <li><code>profile.json</code> \u2192 defines birth month, MAGI, and simulation horizon (end month).</li> <li><code>balance.csv</code> \u2192 seed buckets and their balances. These need to align to buckets defined in <code>buckets.json</code>. Forecasting starts in the month after the last month in <code>balance.csv</code>.</li> <li><code>recurring.csv</code> \u2192 ongoing monthly expenses (e.g., insurance, food, utilities). Use today dollar amounts. Types need to align to category profiles in <code>inflation_rates.json</code> for proper inflation over the years.</li> <li><code>fixed.csv</code> \u2192 one\u2011time events (e.g., tuition, travel). File is required, but may be empty. Use today dollar amounts. Types need to align to category profiles in <code>inflation_rates.json</code> for proper inflation over the years.</li> </ul>"},{"location":"configuration/#recommended","title":"RECOMMENDED","text":"<p>For meaningful results, you should also review and revise:</p> <ul> <li><code>buckets.json</code> \u2192 defines portfolio buckets and sub\u2011holdings. Note: Align with <code>balance.csv</code>.</li> <li><code>policies.json</code> \u2192 defines salary, social security, property details for mortgage payments, and unemployment. Note: Update salary, social security, property details and unemployment values as needed.</li> <li><code>tax_brackets.json</code> \u2192 defaulting to Married\u2011Filing\u2011Jointly, defines federal and Oregon state tax brackets. Note: Code changes are needed for other filing types or states; contact me if interested.</li> <li><code>marketplace_premiums.json</code> \u2192 healthcare premiums for marketplace plans. Note: update premium amounts as needed.</li> </ul>"},{"location":"configuration/#advanced","title":"ADVANCED","text":"<p>For deeper scenario analysis and IRS\u2011aligned modeling, configure:</p> <ul> <li><code>buckets.json</code> \u2192 defines portfolio buckets and sub\u2011holdings. Note: Modify sub-holdings per bucket to drive forecasted gains based on your investment strategy.</li> <li><code>policies.json</code> \u2192 defines refill rules, liquidation hierarchy, RMD, 3-phase roth conversion model, sepp withdrawals. Note: Update policies to tailor to your goals.</li> <li><code>inflation_rates.json</code> \u2192 baseline inflation + category profiles. Note: currently based on 2000-2025 data. Update as needed.</li> <li><code>inflation_thresholds.json</code> + <code>gain_table.json</code> \u2192 asset class return regimes for Monte Carlo sampling. Note: currently based on 2000-2025 data. Update as needed.</li> </ul>"},{"location":"configuration/#json-configuration","title":"\ud83d\udcc2 JSON Configuration","text":""},{"location":"configuration/#profiles","title":"Profiles","text":"<p>Defines the simulation timeframe and baseline income assumptions. This file is consumed during staging (<code>stage_init_components</code>) to determine retirement eligibility, SEPP gating, and IRMAA premium thresholds.</p> <p>Example (<code>profile.json</code>):</p> <pre><code>{\n  \"Birth Month\": \"1975-04\",\n  \"End Month\": \"2065-12\",\n  \"MAGI\": {\n    \"2023\": 200000,\n    \"2024\": 204000,\n    \"2025\": 208000\n  }\n}\n</code></pre>"},{"location":"configuration/#profiles-field-definitions","title":"\ud83d\udd11 Profiles Field Definitions","text":"<ul> <li>Birth Month \u2192 start of simulation, expressed as <code>YYYY-MM</code>.</li> <li>End Month \u2192 end of simulation horizon, expressed as <code>YYYY-MM</code>.</li> <li>MAGI \u2192 dictionary of Modified Adjusted Gross Income values by year.</li> <li>Keys are years (<code>2023</code>, <code>2024</code>, <code>2025</code>).</li> <li>Values are annual MAGI amounts.</li> <li>Used for IRMAA premium calculations and tax logic.</li> </ul>"},{"location":"configuration/#profiles-audit-notes","title":"\ud83e\uddfe Profiles Audit Notes","text":"<ul> <li>Birth Month is used to calculate retirement eligibility (e.g., age 59.5 for penalty\u2011free withdrawals).</li> <li>End Month defines the final forecast period.</li> <li>MAGI values feed into IRMAA thresholds and Medicare premium adjustments.</li> <li>All dates are parsed into <code>pandas.Period(\"M\")</code> for monthly granularity.</li> <li>Audit clarity: profiles must be updated annually to reflect current MAGI values.</li> </ul>"},{"location":"configuration/#buckets","title":"Buckets","text":"<p>Defines accounts and their attributes. Each bucket must have a corresponding entry in <code>buckets.json</code>.</p> <p>Example (<code>buckets.json</code>):</p> <pre><code>{\n  \"Cash\": {\n    \"holdings\": [{ \"asset_class\": \"Cash\", \"weight\": 1.0 }],\n    \"can_go_negative\": true,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"cash\"\n  },\n  \"CD Ladder\": {\n    \"holdings\": [\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.995 },\n      { \"asset_class\": \"Cash\", \"weight\": 0.005 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"taxable\"\n  },\n  \"Brokerage\": {\n    \"holdings\": [\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.32 },\n      { \"asset_class\": \"Stocks\", \"weight\": 0.66 },\n      { \"asset_class\": \"Cash\", \"weight\": 0.02 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"taxable\"\n  },\n  \"Tax-Deferred\": {\n    \"holdings\": [\n      { \"asset_class\": \"Stocks\", \"weight\": 0.9 },\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.05 },\n      { \"asset_class\": \"Cash\", \"weight\": 0.05 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"tax_deferred\"\n  },\n  \"Tax-Free\": {\n    \"holdings\": [\n      { \"asset_class\": \"Stocks\", \"weight\": 0.45 },\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.45 },\n      { \"asset_class\": \"Cash\", \"weight\": 0.1 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"tax_free\"\n  },\n  \"Health Savings Account\": {\n    \"holdings\": [\n      { \"asset_class\": \"Stocks\", \"weight\": 0.1 },\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.85 },\n      { \"asset_class\": \"Cash\", \"weight\": 0.05 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": true,\n    \"bucket_type\": \"other\"\n  },\n  \"Vehicles\": {\n    \"holdings\": [{ \"asset_class\": \"Vehicles\", \"weight\": 1.0 }],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"other\"\n  },\n  \"Property\": {\n    \"holdings\": [\n      { \"asset_class\": \"Property\", \"weight\": 1.0, \"cost_basis\": 388000 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"property\"\n  },\n  \"529K\": {\n    \"holdings\": [\n      { \"asset_class\": \"Stocks\", \"weight\": 0.5 },\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.5 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": true,\n    \"bucket_type\": \"other\"\n  },\n  \"SEPP IRA\": {\n    \"holdings\": [\n      { \"asset_class\": \"Fixed-Income\", \"weight\": 0.4 },\n      { \"asset_class\": \"Stocks\", \"weight\": 0.6 }\n    ],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": false,\n    \"bucket_type\": \"tax_deferred\"\n  },\n  \"Tax Collection\": {\n    \"holdings\": [{ \"asset_class\": \"Cash\", \"weight\": 1.0 }],\n    \"can_go_negative\": false,\n    \"allow_cash_fallback\": true,\n    \"bucket_type\": \"other\"\n  }\n}\n</code></pre>"},{"location":"configuration/#buckets-field-definitions","title":"\ud83d\udd11 Buckets Field Definitions","text":"<ul> <li><code>holdings</code> \u2192 list of asset allocations with weights (must sum to ~1.0).</li> <li>Optional: <code>cost_basis</code> for property or other assets.</li> <li><code>can_go_negative</code> \u2192 allows overdrafts (e.g., Cash bucket).</li> <li><code>allow_cash_fallback</code> \u2192 allows automatic fallback to Cash if bucket is insufficient.</li> <li><code>bucket_type</code> \u2192 classification:</li> <li><code>cash</code> \u2192 liquid cash bucket.</li> <li><code>taxable</code> \u2192 brokerage or CD ladder accounts.</li> <li><code>tax_deferred</code> \u2192 retirement accounts (401k, IRA, SEPP IRA).</li> <li><code>tax_free</code> \u2192 Roth or other tax\u2011free accounts.</li> <li><code>property</code> \u2192 real estate holdings with explicit cost basis.</li> <li><code>other</code> \u2192 vehicles, HSAs, 529K, or miscellaneous accounts.</li> </ul>"},{"location":"configuration/#buckets-audit-notes","title":"\ud83e\uddfe Buckets Audit Notes","text":"<ul> <li>Buckets are seeded from the last row of <code>balance.csv</code> via <code>seed_buckets_from_config</code>.</li> <li><code>create_bucket</code> ensures rounding drift is corrected when allocating holdings.</li> <li>A Tax Collection bucket is always present for withholding and settlement.</li> <li>Property buckets should include <code>cost_basis</code> for IRS compliance.</li> <li>Cash bucket may allow negative balances to model overdrafts.</li> </ul>"},{"location":"configuration/#policies","title":"Policies","text":"<p>Defines refill, liquidation, salary, retirement, and special rules. These policies drive how transactions, withdrawals, and conversions are applied in the simulation.</p> <p>Example (<code>policies.json</code>):</p> <pre><code>{\n  \"Refill\": {\n    \"Thresholds\": { \"Cash\": 30000 },\n    \"Amounts\": { \"Cash\": 20000 },\n    \"Sources\": { \"Cash\": [\"SEPP IRA\", \"Tax-Deferred\", \"Brokerage\", \"Tax-Free\"] }\n  },\n  \"Liquidation\": {\n    \"Threshold\": -15000,\n    \"Sources\": [\"CD Ladder\", \"Tax-Free\", \"Vehicles\", \"Property\"],\n    \"Targets\": { \"Cash\": 0.2, \"Brokerage\": 0.8 }\n  },\n  \"Salary\": {\n    \"Targets\": { \"Cash\": 0.9, \"Tax-Deferred\": 0.1 },\n    \"Annual Gross Income\": 180000,\n    \"Annual Bonus Month\": \"2026-04\",\n    \"Annual Bonus Amount\": 15000,\n    \"Annual Merit Increase Rate\": 0.025,\n    \"Annual Merit Increase Month\": \"2026-03\",\n    \"Retirement Month\": \"2033-12\"\n  },\n  \"Social Security\": [\n    {\n      \"Profile\": \"p1\",\n      \"DOB\": \"1975-04\",\n      \"Target\": \"Cash\",\n      \"Full Age\": \"67\",\n      \"Full Benefit\": 4058,\n      \"Start Age\": \"67\",\n      \"Percentage Payout\": 0.8\n    },\n    {\n      \"Profile\": \"p2\",\n      \"DOB\": \"1978-07\",\n      \"Target\": \"Cash\",\n      \"Full Age\": \"67\",\n      \"Full Benefit\": 1569,\n      \"Start Age\": \"67\",\n      \"Percentage Payout\": 0.8\n    }\n  ],\n  \"RMD\": {\n    \"Targets\": { \"Cash\": 0.2, \"CD Ladder\": 0.4, \"Brokerage\": 0.4 }\n  },\n  \"Roth Conversions\": {\n    \"early\": {\n      \"Max Tax Rate\": 0.15,\n      \"Max Conversion Amount\": 50000,\n      \"Tax Source Threshold\": 500000,\n      \"Tax Source Name\": \"Brokerage\",\n      \"Allow Conversion\": true,\n      \"Cutoff Age\": 60\n    },\n    \"prime\": {\n      \"Max Tax Rate\": 0.2,\n      \"Max Conversion Amount\": 80000,\n      \"Tax Source Threshold\": 1200000,\n      \"Tax Source Name\": \"Tax-Deferred\",\n      \"Allow Conversion\": true,\n      \"Cutoff Age\": 80\n    },\n    \"late\": {\n      \"Max Tax Rate\": 0.2,\n      \"Max Conversion Amount\": 100000,\n      \"Tax Source Threshold\": 800000,\n      \"Tax Source Name\": \"Tax-Deferred\",\n      \"Allow Conversion\": true,\n      \"Cutoff Age\": 100\n    }\n  },\n  \"SEPP\": {\n    \"Enabled\": false,\n    \"Start Month\": \"2029-10\",\n    \"End Month\": \"2034-09\",\n    \"Interest Rate\": 0.05,\n    \"Source\": \"SEPP IRA\",\n    \"Target\": \"Cash\"\n  },\n  \"Property\": {\n    \"Market Value\": 550000,\n    \"Annual Maintenance\": 0.0075,\n    \"Remaining Principal\": 247102.54,\n    \"Mortgage APR\": 0.05375,\n    \"Monthly Principal and Interest\": 2666.43,\n    \"Monthly Taxes\": 724.0,\n    \"Monthly Insurance\": 169.4,\n    \"Monthly Rent\": 2500\n  },\n  \"Unemployment\": {\n    \"Start Month\": \"2034-01\",\n    \"End Month\": \"2034-07\",\n    \"Monthly Amount\": \"4000\",\n    \"Target\": \"Cash\"\n  }\n}\n</code></pre>"},{"location":"configuration/#policies-field-definitions","title":"\ud83d\udd11 Policies Field Definitions","text":"<ul> <li> <p>Refill</p> </li> <li> <p><code>Thresholds</code> \u2192 minimum balances to maintain (e.g., Cash \u2265 30,000).</p> </li> <li><code>Amounts</code> \u2192 refill increments when thresholds are breached.</li> <li> <p><code>Sources</code> \u2192 buckets tapped to refill targets.</p> </li> <li> <p>Liquidation</p> </li> <li> <p><code>Threshold</code> \u2192 minimum balance before liquidation triggers.</p> </li> <li><code>Sources</code> \u2192 buckets liquidated in order.</li> <li> <p><code>Targets</code> \u2192 distribution of liquidation proceeds across buckets.</p> </li> <li> <p>Salary</p> </li> <li> <p><code>Targets</code> \u2192 allocation of salary into buckets (e.g., 90% Cash, 10% Tax\u2011Deferred).</p> </li> <li><code>Annual Gross Income</code> \u2192 base salary.</li> <li><code>Annual Bonus Month</code> / <code>Annual Bonus Amount</code> \u2192 bonus timing and value.</li> <li><code>Annual Merit Increase Rate</code> / <code>Month</code> \u2192 annual raise percentage and timing.</li> <li> <p><code>Retirement Month</code> \u2192 month salary stops.</p> </li> <li> <p>Social Security</p> </li> <li> <p>Array of profiles (one per person).</p> </li> <li><code>DOB</code> \u2192 date of birth.</li> <li><code>Target</code> \u2192 bucket receiving benefits.</li> <li><code>Full Age</code> / <code>Full Benefit</code> \u2192 baseline entitlement.</li> <li><code>Start Age</code> \u2192 age benefits begin.</li> <li> <p><code>Percentage Payout</code> \u2192 fraction of full benefit taken.</p> </li> <li> <p>RMD (Required Minimum Distribution)</p> </li> <li> <p><code>Targets</code> \u2192 distribution of mandatory withdrawals across buckets.</p> </li> <li> <p>Roth Conversions</p> </li> <li> <p>Multiple phases (<code>early</code>, <code>prime</code>, <code>late</code>).</p> </li> <li>Each defines max tax rate, conversion amount, source thresholds, and cutoff age.</li> <li> <p><code>Allow Conversion</code> \u2192 enables/disables conversions.</p> </li> <li> <p>SEPP (Substantially Equal Periodic Payments)</p> </li> <li> <p><code>Enabled</code> \u2192 toggle for IRS 72(t) withdrawals.</p> </li> <li><code>Start Month</code> / <code>End Month</code> \u2192 duration of SEPP plan.</li> <li><code>Interest Rate</code> \u2192 used in SEPP calculation.</li> <li> <p><code>Source</code> / <code>Target</code> \u2192 buckets for SEPP transfers.</p> </li> <li> <p>Property</p> </li> <li> <p><code>Market Value</code> \u2192 current property valuation.</p> </li> <li><code>Annual Maintenance</code> \u2192 fraction of value spent annually.</li> <li><code>Remaining Principal</code> \u2192 outstanding mortgage balance.</li> <li><code>Mortgage APR</code> \u2192 loan interest rate.</li> <li><code>Monthly Principal and Interest</code> \u2192 scheduled mortgage payment.</li> <li><code>Monthly Taxes</code> / <code>Insurance</code> \u2192 fixed monthly costs.</li> <li> <p><code>Monthly Rent</code> \u2192 rental income if applicable.</p> </li> <li> <p>Unemployment</p> </li> <li><code>Start Month</code> / <code>End Month</code> \u2192 duration of unemployment benefits.</li> <li><code>Monthly Amount</code> \u2192 benefit amount.</li> <li><code>Target</code> \u2192 bucket receiving benefits.</li> </ul>"},{"location":"configuration/#policies-audit-notes","title":"\ud83e\uddfe Policies Audit Notes","text":"<ul> <li>Policies are consumed by <code>stage_init_components</code> and wired into the <code>ForecastEngine</code>.</li> <li>Refill and liquidation rules enforce liquidity thresholds.</li> <li>Salary and Social Security profiles model income streams.</li> <li>RMD and SEPP enforce IRS withdrawal rules.</li> <li>Roth conversions model tax\u2011optimized transfers across phases.</li> <li>Property policy integrates mortgage, maintenance, and rental flows.</li> <li>Unemployment policy allows temporary income replacement.</li> </ul>"},{"location":"configuration/#tax-brackets","title":"\ud83d\udcc2 Tax Brackets","text":"<p>Defines IRS\u2011aligned brackets, payroll taxes, capital gains, Social Security taxability, and Medicare premiums. These rules are consumed by the <code>TaxCalculator</code> and applied in the monthly forecast loop.</p> <p>Example (<code>tax_brackets.json</code>):</p> <pre><code>{\n  \"Standard Deduction\": 31500,\n  \"Ordinary\": {\n    \"Federal 2025\": [\n      { \"min_salary\": 0, \"tax_rate\": 0.1 },\n      { \"min_salary\": 22000, \"tax_rate\": 0.12 },\n      { \"min_salary\": 89450, \"tax_rate\": 0.22 },\n      { \"min_salary\": 190750, \"tax_rate\": 0.24 },\n      { \"min_salary\": 364200, \"tax_rate\": 0.32 },\n      { \"min_salary\": 462500, \"tax_rate\": 0.35 },\n      { \"min_salary\": 751600, \"tax_rate\": 0.37 }\n    ],\n    \"Oregon State 2025\": [\n      { \"min_salary\": 0, \"tax_rate\": 0.0475 },\n      { \"min_salary\": 8601, \"tax_rate\": 0.0675 },\n      { \"min_salary\": 21501, \"tax_rate\": 0.0875 },\n      { \"min_salary\": 250000, \"tax_rate\": 0.099 }\n    ],\n    \"Portland Metro SHS 2025\": [{ \"min_salary\": 200000, \"tax_rate\": 0.01 }]\n  },\n  \"Payroll Specific\": {\n    \"Social Security 2025\": [\n      { \"min_salary\": 0, \"tax_rate\": 0.062 },\n      { \"min_salary\": 176100, \"tax_rate\": 0.0 }\n    ],\n    \"Medicare 2025\": [\n      { \"min_salary\": 0, \"tax_rate\": 0.0145 },\n      { \"min_salary\": 200000, \"tax_rate\": 0.0235 }\n    ]\n  },\n  \"Capital Gains\": {\n    \"long_term\": [\n      { \"min_salary\": 0, \"tax_rate\": 0.0 },\n      { \"min_salary\": 89250, \"tax_rate\": 0.15 },\n      { \"min_salary\": 553850, \"tax_rate\": 0.2 }\n    ]\n  },\n  \"Social Security Taxability\": [\n    { \"min_provisional\": 0, \"rate\": 0.0 },\n    { \"min_provisional\": 32000, \"rate\": 0.5 },\n    { \"min_provisional\": 44000, \"rate\": 0.85 }\n  ],\n  \"IRMAA 2025\": [\n    { \"max_magi\": 206000, \"part_b\": 185.0, \"part_d\": 0.0 },\n    { \"max_magi\": 258000, \"part_b\": 259.2, \"part_d\": 12.9 },\n    { \"max_magi\": 322000, \"part_b\": 331.7, \"part_d\": 33.3 },\n    { \"max_magi\": 386000, \"part_b\": 404.2, \"part_d\": 53.8 },\n    { \"max_magi\": 750000, \"part_b\": 476.7, \"part_d\": 74.2 },\n    { \"max_magi\": 999999999, \"part_b\": 549.3, \"part_d\": 81.0 }\n  ],\n  \"Medicare Base Premiums 2025\": {\n    \"part_b\": 174.7,\n    \"part_d\": 30.0\n  }\n}\n</code></pre>"},{"location":"configuration/#tax-brackets-field-definitions","title":"\ud83d\udd11 Tax Brackets Field Definitions","text":"<ul> <li>Tax Brackets: Standard Deduction \u2192 baseline deduction applied before taxable income calculation.</li> <li>Tax Brackets: Ordinary \u2192 progressive brackets for federal, state, and local income taxes.</li> <li>Keys are jurisdiction + year (e.g., <code>Federal 2025</code>, <code>Oregon State 2025</code>).</li> <li>Each bracket defines <code>min_salary</code> and <code>tax_rate</code>.</li> <li>Tax Brackets: Payroll Specific \u2192 Social Security and Medicare payroll taxes.</li> <li>Social Security capped at wage base (<code>176,100</code> in 2025).</li> <li>Medicare includes additional surtax above thresholds.</li> <li>Tax Brackets: Capital Gains \u2192 long\u2011term capital gains brackets layered above ordinary income.</li> <li>Tax Brackets: Social Security Taxability \u2192 provisional income thresholds (0%, 50%, 85%).</li> <li>Tax Brackets: IRMAA 2025 \u2192 income\u2011related Medicare premium adjustments (Part B and Part D).</li> <li>Tax Brackets: Medicare Base Premiums 2025 \u2192 baseline monthly premiums for Part B and Part D.</li> </ul>"},{"location":"configuration/#tax-brackets-audit-notes","title":"\ud83e\uddfe Tax Brackets Audit Notes","text":"<ul> <li>Tax brackets are consumed by <code>TaxCalculator</code> during year\u2011end settlement.</li> <li>Federal, state, and local brackets are layered to compute total ordinary income tax.</li> <li>Payroll taxes (Social Security, Medicare) are applied monthly to salary flows.</li> <li>Capital gains brackets are applied after ordinary income.</li> <li>Social Security taxability capped at 85% of provisional income.</li> <li>IRMAA thresholds adjust Medicare premiums based on MAGI.</li> <li>Standard deduction reduces taxable income before bracket application.</li> <li>All values are year\u2011specific and must be updated annually for compliance.</li> </ul>"},{"location":"configuration/#inflation","title":"Inflation","text":"<p>Defines baseline inflation assumptions, category\u2011specific profiles, and how inflation interacts with asset class returns. These values are consumed by <code>InflationGenerator</code> and adjusted via <code>build_description_inflation_modifiers</code> to produce year\u2011by\u2011year modifiers. The <code>MarketGains</code> component then uses <code>inflation_thresholds.json</code> and <code>gain_table.json</code> to determine asset class returns under Low, Average, or High regimes.</p>"},{"location":"configuration/#example-inflation_ratesjson","title":"Example (<code>inflation_rates.json</code>)","text":"<pre><code>{\n  \"default\": { \"avg\": 0.023, \"std\": 0.02 },\n  \"profiles\": {\n    \"Education\": { \"avg\": 0.045, \"std\": 0.025 },\n    \"Entertainment\": { \"avg\": 0.028, \"std\": 0.02 },\n    \"Food\": { \"avg\": 0.03, \"std\": 0.02 },\n    \"Goods\": { \"avg\": 0.02, \"std\": 0.015 },\n    \"Health\": { \"avg\": 0.035, \"std\": 0.015 },\n    \"Property Insurance\": { \"avg\": 0.05, \"std\": 0.03 },\n    \"Property Maintenance\": { \"avg\": 0.025, \"std\": 0.012 },\n    \"Property Taxes\": { \"avg\": 0.03, \"std\": 0.015 },\n    \"Rent\": { \"avg\": 0.025, \"std\": 0.01 },\n    \"Restaurants\": { \"avg\": 0.033, \"std\": 0.02 },\n    \"Subscriptions\": { \"avg\": 0.02, \"std\": 0.01 },\n    \"Travel\": { \"avg\": 0.035, \"std\": 0.03 },\n    \"Utilities\": { \"avg\": 0.02, \"std\": 0.02 },\n    \"Vehicle Insurance\": { \"avg\": 0.025, \"std\": 0.02 },\n    \"Vehicle Maintenance\": { \"avg\": 0.025, \"std\": 0.015 },\n    \"Voice and Data\": { \"avg\": 0.0075, \"std\": 0.01 }\n  }\n}\n</code></pre>"},{"location":"configuration/#example-inflation_thresholdsjson","title":"Example (<code>inflation_thresholds.json</code>)","text":"<pre><code>{\n  \"Stocks\": { \"low\": 0.015, \"high\": 0.035 },\n  \"Fixed-Income\": { \"low\": 0.01, \"high\": 0.03 },\n  \"Property\": { \"low\": 0.015, \"high\": 0.04 },\n  \"Vehicles\": { \"low\": 0.0, \"high\": 0.0 },\n  \"Cash\": { \"low\": 0.0, \"high\": 0.0 }\n}\n</code></pre>"},{"location":"configuration/#example-gain_tablejson","title":"Example (<code>gain_table.json</code>)","text":"<pre><code>{\n  \"Stocks\": {\n    \"Low\": { \"avg\": 0.004, \"std\": 0.04 },\n    \"Average\": { \"avg\": 0.0065, \"std\": 0.044 },\n    \"High\": { \"avg\": 0.008, \"std\": 0.05 }\n  },\n  \"Fixed-Income\": {\n    \"Low\": { \"avg\": 0.0015, \"std\": 0.0002 },\n    \"Average\": { \"avg\": 0.0025, \"std\": 0.0004 },\n    \"High\": { \"avg\": 0.004, \"std\": 0.0004 }\n  },\n  \"Property\": {\n    \"Low\": { \"avg\": 0.0005, \"std\": 0.0008 },\n    \"Average\": { \"avg\": 0.0025, \"std\": 0.0012 },\n    \"High\": { \"avg\": 0.0025, \"std\": 0.0012 }\n  },\n  \"Vehicles\": {\n    \"Low\": { \"avg\": -0.01, \"std\": 0.0 },\n    \"Average\": { \"avg\": -0.01, \"std\": 0.0 },\n    \"High\": { \"avg\": -0.01, \"std\": 0.0 }\n  },\n  \"Cash\": {\n    \"Low\": { \"avg\": 0.0, \"std\": 0.0 },\n    \"Average\": { \"avg\": 0.0, \"std\": 0.0 },\n    \"High\": { \"avg\": 0.0, \"std\": 0.0 }\n  }\n}\n</code></pre>"},{"location":"configuration/#inflation-field-definitions","title":"\ud83d\udd11 Inflation Field Definitions","text":"<ul> <li> <p>default</p> </li> <li> <p><code>avg</code> \u2192 baseline average annual inflation rate.</p> </li> <li> <p><code>std</code> \u2192 baseline standard deviation (volatility).</p> </li> <li> <p>profiles</p> </li> <li> <p>Each key represents a spending or asset category (e.g., Education, Food, Rent).</p> </li> <li><code>avg</code> \u2192 category\u2011specific average inflation rate.</li> <li><code>std</code> \u2192 category\u2011specific volatility.</li> <li> <p>Categories include property costs (insurance, maintenance, taxes), household expenses (utilities, food, subscriptions), and discretionary spending (travel, entertainment).</p> </li> <li> <p>thresholds (<code>inflation_thresholds.json</code>)</p> </li> <li> <p>Defines inflation cutoffs for each asset class.</p> </li> <li>If inflation &lt; <code>low</code> \u2192 Low regime.</li> <li>If between <code>low</code> and <code>high</code> \u2192 Average regime.</li> <li> <p>If inflation &gt; <code>high</code> \u2192 High regime.</p> </li> <li> <p>gain table (<code>gain_table.json</code>)</p> </li> <li>Defines return distributions for each asset class under Low, Average, and High regimes.</li> <li><code>avg</code> \u2192 mean monthly return.</li> <li><code>std</code> \u2192 volatility of monthly returns.</li> <li>Vehicles modeled as depreciating assets (negative returns).</li> <li>Cash modeled as stable with zero returns.</li> </ul>"},{"location":"configuration/#inflation-audit-notes","title":"\ud83e\uddfe Inflation Audit Notes","text":"<ul> <li>Inflation defaults anchor the stochastic generator (<code>InflationGenerator</code>).</li> <li>Profiles are adjusted against defaults by <code>build_description_inflation_modifiers</code>.</li> <li>Thresholds determine which regime (Low, Average, High) applies to each asset class.</li> <li>Gain tables provide stochastic return distributions for the selected regime.</li> <li>Each profile produces year\u2011by\u2011year modifiers applied to transactions (e.g., rent, property maintenance, healthcare).</li> <li>Ensures category\u2011specific realism (e.g., healthcare inflates faster than goods, vehicles depreciate).</li> <li>Randomness seeded per trial for reproducibility.</li> <li>Audit clarity: modifiers, thresholds, and gain tables are logged and can be traced back to configuration definitions.</li> </ul>"},{"location":"configuration/#marketplace-premiums","title":"Marketplace Premiums","text":"<p>Defines health insurance premiums for marketplace plans. These values are consumed by the simulation to model monthly healthcare costs and interact with MAGI thresholds (e.g., IRMAA adjustments).</p> <p>Example (<code>marketplace_premiums.json</code>):</p> <pre><code>{\n  \"silver_family\": {\n    \"monthly_premium\": 1750\n  },\n  \"silver_couple\": {\n    \"monthly_premium\": 1250\n  }\n}\n</code></pre>"},{"location":"configuration/#marketplace-premiums-field-definitions","title":"\ud83d\udd11 Marketplace Premiums Field Definitions","text":"<ul> <li>Plan Key \u2192 identifier for the plan type (e.g., <code>silver_family</code>, <code>silver_couple</code>).</li> <li>monthly_premium \u2192 monthly premium cost in dollars.</li> <li>Applied as a recurring monthly expense in the forecast loop.</li> <li>Can be extended to include additional tiers (e.g., <code>silver_individual</code>, <code>gold_family</code>).</li> </ul>"},{"location":"configuration/#marketplace-premiums-audit-notes","title":"\ud83e\uddfe Marketplace Premiums Audit Notes","text":"<ul> <li>Premiums are modeled as fixed monthly expenses unless overridden by inflation profiles (e.g., Health).</li> <li>Values feed into expense transactions and reduce available cash balances.</li> <li>MAGI values from <code>profile.json</code> interact with IRMAA thresholds, but marketplace premiums are modeled separately.</li> <li>Audit clarity: premiums must be updated annually to reflect marketplace rates.</li> <li>Plan keys should match naming conventions used in transaction logic to avoid misalignment.</li> </ul>"},{"location":"configuration/#csv-inputs","title":"\ud83d\udcc2 CSV Inputs","text":""},{"location":"configuration/#balances","title":"Balances","text":"<p>Defines historical monthly balances for each bucket. This file seeds the simulation with starting balances and is consumed by <code>stage_prepare_timeframes</code> and <code>seed_buckets_from_config</code>.</p> <p>Example (<code>balances.csv</code>):</p> <pre><code>Month,Cash,CD Ladder,Brokerage,Tax-Deferred,Tax-Free,Health Savings Account,Vehicles,Property,529K,SEPP IRA\n2023-01,19678,31757,145633,478275,66656,12017,54580,661474,68434,0\n2023-02,20188,32347,154680,541963,71379,12652,55476,672413,64942,0\n...\n2025-12,23256,73685,182139,793123,136612,33079,81526,1068649,116233,0\n</code></pre>"},{"location":"configuration/#balances-field-definitions","title":"\ud83d\udd11 Balances Field Definitions","text":"<ul> <li>Month \u2192 simulation period in <code>YYYY-MM</code> format.</li> <li>Cash \u2192 liquid cash balance.</li> <li>CD Ladder \u2192 certificate of deposit ladder account.</li> <li>Brokerage \u2192 taxable brokerage account.</li> <li>Tax-Deferred \u2192 retirement accounts (e.g., 401k, IRA).</li> <li>Tax-Free \u2192 Roth or other tax\u2011free accounts.</li> <li>Health Savings Account \u2192 HSA balances.</li> <li>Vehicles \u2192 depreciating vehicle assets.</li> <li>Property \u2192 real estate holdings (linked to <code>Property</code> policy).</li> <li>529K \u2192 education savings account.</li> <li>SEPP IRA \u2192 IRA designated for Substantially Equal Periodic Payments.</li> </ul>"},{"location":"configuration/#balances-audit-notes","title":"\ud83e\uddfe Balances Audit Notes","text":"<ul> <li>The last row of <code>balances.csv</code> is used by <code>seed_buckets_from_config</code> to initialize starting balances for each bucket.</li> <li>All bucket names must match those defined in <code>buckets.json</code>.</li> <li>Vehicles and Property balances are tracked as assets but modeled with depreciation or mortgage flows.</li> <li>SEPP IRA balance is critical for IRS 72(t) withdrawal modeling.</li> <li>FlowTracker records debits/credits against these balances for audit clarity.</li> <li>Audit reproducibility: balances must align with external statements for defensibility.</li> </ul>"},{"location":"configuration/#fixed-transactions","title":"Fixed Transactions","text":"<p>Defines one\u2011time transactions that occur in a specific month. This file is consumed by <code>stage_init_components</code> and applied in the monthly forecast loop.</p> <p>Example (<code>fixed.csv</code>):</p> <pre><code>Month,Bucket,Amount,Type,Description\n2026-09,529K,-25000,Education,College Tuition #1\n2027-09,529K,-25000,Education,College Tuition #2\n2028-09,529K,-35000,Education,College Tuition #3\n2029-09,529K,-35000,Education,College Tuition #4\n2026-07,CD Ladder,-10000,Travel,Travel to Japan\n2027-07,CD Ladder,-10000,Travel,Travel to Alaska\n2030-10,CD Ladder,-10000,Travel,Travel to Europe\n2035-10,CD Ladder,-10000,Travel,Travel to SE Asia\n2040-07,CD Ladder,-10000,Travel,Travel to Aus/NZ\n</code></pre>"},{"location":"configuration/#fixed-transactions-field-definitions","title":"\ud83d\udd11 Fixed Transactions Field Definitions","text":"<ul> <li>Month \u2192 date of transaction (<code>YYYY-MM</code>).</li> <li>Bucket \u2192 target bucket impacted by the transaction (e.g., <code>529K</code>, <code>CD Ladder</code>).</li> <li>Amount \u2192 transaction value (negative for outflows, positive for inflows).</li> <li>Type \u2192 category of transaction (e.g., Education, Travel).</li> <li>Description \u2192 human\u2011readable label for audit clarity (e.g., \u201cCollege Tuition #1\u201d).</li> </ul>"},{"location":"configuration/#fixed-transactions-audit-notes","title":"\ud83e\uddfe Fixed Transactions Audit Notes","text":"<ul> <li>Fixed transactions are applied once at the specified month.</li> <li>Amounts reduce or increase balances in the designated bucket.</li> <li>Categories (Education, Travel) can be linked to inflation profiles for realism (e.g., tuition inflates faster than goods).</li> <li>FlowTracker logs each transaction for reproducibility.</li> <li>Audit clarity: descriptions should match external records (e.g., tuition invoices, travel receipts).</li> </ul>"},{"location":"configuration/#recurring-transactions","title":"Recurring Transactions","text":"<p>Defines ongoing monthly transactions that repeat between a start and end month. This file is consumed by <code>stage_init_components</code> and applied in the monthly forecast loop.</p> <p>Example (<code>recurring.csv</code>):</p> <pre><code>Start Month,End Month,Bucket,Amount,Type,Description\n2025-09,2029-09,Cash,-290,Vehicle Insurance,Vehicle Insurance\n2029-10,2075-12,Cash,-190,Vehicle Insurance,Vehicle Insurance\n2025-09,2029-09,Cash,-400,Vehicle Maintenance,Vehicle Maintenance\n2029-10,2075-12,Cash,-300,Vehicle Maintenance,Vehicle Maintenance\n2025-09,2029-09,Cash,-140,Entertainment,Entertainment Parks and Rec\n2029-10,2075-12,Cash,-140,Entertainment,Entertainment Parks and Rec\n2025-09,2029-09,Cash,-95,Subscriptions,Entertainment Subscriptions\n2029-10,2075-12,Cash,-95,Subscriptions,Entertainment Subscriptions\n2025-09,2029-09,Cash,-800,Food,Food Groceries\n2029-10,2075-12,Cash,-600,Food,Food Groceries\n2025-09,2029-09,Cash,-200,Restaurants,Food Restaurants\n2029-10,2075-12,Cash,-200,Restaurants,Food Restaurants\n2025-09,2029-09,Cash,-800,Goods,Goods\n2029-10,2075-12,Cash,-600,Goods,Goods\n2025-08,2029-09,Cash,-500,Health,Health Medical Insurance\n2025-08,2029-09,Cash,-15,Health,Health Dental Insurance\n2025-08,2029-09,Cash,-5,Health,Health Vision Insurance\n2025-09,2030-04,Cash,-325,Health,Health Prescriptions etc\n2029-10,2050-04,Health Savings Account,-425,Health,Health Prescriptions etc\n2050-04,2075-12,Health Savings Account,-725,Health,Health Prescriptions etc\n2025-09,2029-09,Cash,-400,Travel,Travel in US\n2029-10,2075-12,Cash,-600,Travel,Travel in US\n2025-09,2075-12,Cash,-345,Utilities,Utils Elec and Gas\n2025-09,2075-12,Cash,-300,Utilities,Utils Waste and Water\n2025-08,2026-12,Cash,-345,Voice and Data,Utils Voice and Data\n2027-01,2075-12,Cash,-250,Voice and Data,Utils Voice and Data\n</code></pre>"},{"location":"configuration/#recurring-transactions-field-definitions","title":"\ud83d\udd11 Recurring Transactions Field Definitions","text":"<ul> <li>Start Month \u2192 first month the transaction occurs (<code>YYYY-MM</code>).</li> <li>End Month \u2192 last month the transaction occurs (<code>YYYY-MM</code>).</li> <li>Bucket \u2192 target bucket impacted by the transaction (e.g., <code>Cash</code>, <code>Health Savings Account</code>).</li> <li>Amount \u2192 monthly transaction value (negative for outflows, positive for inflows).</li> <li>Type \u2192 category of transaction (e.g., Vehicle Insurance, Food, Health, Utilities).</li> <li>Description \u2192 human\u2011readable label for audit clarity (e.g., \u201cHealth Prescriptions etc\u201d).</li> </ul>"},{"location":"configuration/#recurring-transactions-audit-notes","title":"\ud83e\uddfe Recurring Transactions Audit Notes","text":"<ul> <li>Recurring transactions are applied every month between <code>Start Month</code> and <code>End Month</code>.</li> <li>Amounts reduce or increase balances in the designated bucket.</li> <li>Categories (Food, Health, Utilities, Entertainment) can be linked to inflation profiles for realism.</li> <li>Health transactions may shift buckets (Cash \u2192 HSA) depending on policy and time horizon.</li> <li>FlowTracker logs each transaction for reproducibility.</li> <li>Audit clarity: descriptions should match external records (e.g., insurance policies, utility bills).</li> </ul>"},{"location":"configuration/#notes","title":"\ud83e\uddfe Notes","text":"<ul> <li>All months stored as <code>YYYY-MM</code> and parsed into <code>pandas.Period(\"M\")</code>.</li> <li>Buckets must be defined in both <code>balance.csv</code> and <code>buckets.json</code>.</li> <li>Inflation profiles ensure category\u2011specific realism (e.g., Rent inflates faster than Cash).</li> <li>FlowTracker records all debits/credits for audit clarity.</li> </ul>"},{"location":"configuration/#related-pages","title":"\ud83d\udcda Related Pages","text":"<ul> <li>Framework Overview</li> <li>Architecture Overview</li> <li>Simulation Logic</li> <li>Visualization Guide</li> <li>Usage Guide</li> <li>See <code>../src/README.md</code> for source code details.</li> </ul>"},{"location":"overview/","title":"\ud83c\udf10 Framework Overview","text":"<p>Nomad Wealth is a policy-driven financial simulation framework built for transparency, audit clarity, and strategic insight. It models retirement scenarios, withdrawal strategies, and tax implications using Monte Carlo simulations and IRS-aligned rules.</p>"},{"location":"overview/#purpose","title":"\ud83c\udfaf Purpose","text":"<p>The framework helps users and auditors:</p> <ul> <li>Quantify financial sufficiency under uncertainty.</li> <li>Compare scenarios with percentile overlays and reference lines.</li> <li>Trace every dollar across buckets, transactions, and policies.</li> <li>Validate outputs against IRS rules and historical distributions.</li> <li>Export reproducible charts and CSVs for audit and review.</li> </ul>"},{"location":"overview/#core-components","title":"\ud83e\udde9 Core Components","text":"<p>Nomad Wealth is organized into modular layers:</p> <ul> <li>Configuration \u2192 JSON and CSV inputs define buckets, policies, tax brackets, and seed balances.</li> <li>Architecture \u2192 Modular design separates buckets, policies, transactions, economic factors, taxes, and visualization.</li> <li>Simulation Logic (<code>forecast_engine.py</code>) \u2192 Monthly forecast loop applies transactions, policies, market returns, and taxes.</li> <li>Visualization (<code>visualizations.py</code>) \u2192 Interactive charts (historical, per\u2011trial, Monte Carlo) and CSV/HTML exports provide audit clarity and interpretability.</li> <li>Usage \u2192 Flags in <code>app.py</code> control simulation size, chart generation, and export behavior.</li> </ul>"},{"location":"overview/#workflow","title":"\ud83d\udcc2 Workflow","text":"<ol> <li>Configure<ul> <li>Define buckets, policies, and tax rules in JSON.</li> <li>Seed balances and transactions in CSV.</li> </ul> </li> <li>Simulate<ul> <li>Run Monte Carlo trials in parallel.</li> <li>Apply monthly transactions, refill policies, market returns, and taxes.</li> <li>Aggregate results into DataFrames for net worth, taxes, returns, balances, and flow logs.</li> <li>FlowTracker ensures every debit/credit is logged for audit reproducibility.</li> </ul> </li> <li>Visualize<ul> <li>Generate historical charts, per\u2011trial examples, and aggregate Monte Carlo distributions.</li> <li>Export HTML and CSV outputs with consistent color palettes, percentile overlays, and hover text for interpretability.</li> </ul> </li> </ol>"},{"location":"overview/#irs-alignment","title":"\ud83e\uddfe IRS Alignment","text":"<p>The framework enforces IRS rules with explicit, layered logic:</p> <ul> <li>Ordinary income brackets (married filing jointly).</li> <li>Capital gains layered above ordinary income.</li> <li>Social Security taxation capped at 85%.</li> <li>Penalty taxes applied to early withdrawals.</li> <li>Roth conversions modeled independently.</li> <li>IRMAA premiums applied based on prior MAGI, doubled for MFJ.</li> <li>Marketplace premiums capped at 8.5% of prior MAGI.</li> </ul>"},{"location":"overview/#outputs","title":"\ud83d\udcca Outputs","text":"<p>Nomad Wealth produces:</p> <ul> <li>Historical Charts \u2192 bucket gains, net worth trajectory.</li> <li>Per-Trial Charts \u2192 monthly expenses, transactions, taxes, forecasts.</li> <li>Aggregate Monte Carlo Charts \u2192 monthly returns, taxable balances, totals/rates, net worth distribution.</li> <li>CSV/HTML Exports \u2192 balances, taxes, returns, flows, and interactive charts for audit clarity.</li> </ul>"},{"location":"overview/#design-principles","title":"\ud83c\udfaf Design Principles","text":"<ul> <li>Policy-First \u2192 declarative JSON rules drive all behavior.</li> <li>Audit Clarity \u2192 every projection is traceable and reproducible.</li> <li>Extensibility \u2192 modular design supports new transaction types, policies, and tax rules.</li> <li>Resilience \u2192 Monte Carlo sampling embraces volatility and quantifies sufficiency.</li> <li>Transparency \u2192 charts and exports provide clear evidence for auditors and users alike.</li> </ul>"},{"location":"overview/#related-pages","title":"\ud83d\udcda Related Pages","text":"<ul> <li>Configuration Reference</li> <li>Architecture Overview</li> <li>Simulation Logic</li> <li>Visualization Guide</li> <li>Usage Guide</li> </ul>"},{"location":"simulation_logic/","title":"\ud83d\udd04 Simulation Logic","text":"<p>Nomad Wealth\u2019s simulation engine models financial flows month by month, applying transactions, policies, market returns, and taxes. This document explains the sequencing logic of the forecast loop, how trials are staged and executed, and how results are aggregated and visualized.</p>"},{"location":"simulation_logic/#relationship-to-architecture","title":"\ud83e\udde9 Relationship to Architecture","text":"<p>The simulation logic is the operational core of the architecture described in Architecture Overview. Where architecture explains the system\u2019s design principles and modular components, this page focuses on the step\u2011by\u2011step execution flow inside the <code>ForecastEngine</code> and <code>app.py</code>.</p>"},{"location":"simulation_logic/#staging-phase","title":"\ud83d\udcc2 Staging Phase","text":"<p>Before any trial runs, the system prepares inputs and components:</p> <ol> <li> <p>Load Configuration (<code>stage_load</code>)</p> <ul> <li>Loads JSON configuration and CSV inputs.</li> <li>Requires <code>buckets.json</code> under <code>json_data[\"buckets\"]</code>.</li> <li>Returns <code>(json_data, dfs)</code>.</li> </ul> </li> <li> <p>Prepare Timeframes (<code>stage_prepare_timeframes</code>)</p> <ul> <li>Converts <code>Month</code> column to <code>pandas.Period(\"M\")</code>.</li> <li>Adds <code>Tax Collection</code> column to historical balances.</li> <li>Builds <code>future_df</code> with monthly periods until End Month.</li> <li>Returns <code>(hist_df, future_df)</code>.</li> </ul> </li> <li> <p>Initialize Components (<code>stage_init_components</code>)</p> <ul> <li>Builds buckets from config (<code>seed_buckets_from_config</code>).</li> <li>Creates <code>ThresholdRefillPolicy</code> with refill and liquidation rules.</li> <li>Seeds inflation generator (<code>InflationGenerator</code>) and applies modifiers from <code>inflation_rates.json</code>.</li> <li>Initializes <code>TaxCalculator</code> with <code>tax_brackets.json</code> + inflation adjustments.</li> <li>Creates <code>MarketGains</code> using <code>gain_table.json</code> + <code>inflation_thresholds.json</code>.</li> <li>Instantiates transactions from multiple sources:<ul> <li>Fixed Transactions \u2192 <code>fixed.csv</code></li> <li>Recurring Transactions \u2192 <code>recurring.csv</code></li> <li>Property \u2192 mortgage, maintenance, rent flows (<code>policies.json</code>)</li> <li>Rent \u2192 property rental income (<code>policies.json</code>)</li> <li>RMD \u2192 required minimum distributions (<code>policies.json</code>)</li> <li>Unemployment \u2192 temporary income replacement (<code>policies.json</code>)</li> <li>Salary \u2192 wages, bonuses, merit increases (<code>policies.json</code>)</li> <li>Social Security \u2192 benefit profiles (<code>policies.json</code>)</li> </ul> </li> <li>Returns <code>(buckets, refill_policy, tax_calc, market_gains, base_inflation, rule_txns, policy_txns)</code>.</li> </ul> </li> </ol>"},{"location":"simulation_logic/#monthly-forecast-loop","title":"\ud83d\udcc5 Monthly Forecast Loop","text":"<p>Each month in the simulation proceeds through the following steps:</p> <ol> <li> <p>Apply Transactions</p> <ul> <li>Fixed transactions from <code>fixed.csv</code> (e.g., tuition, travel).</li> <li>Recurring transactions from <code>recurring.csv</code> (e.g., insurance, food, utilities).</li> <li>Salary, Social Security, Roth conversions, unemployment, property flows.</li> </ul> </li> <li> <p>Trigger Refill Policies</p> <ul> <li>ThresholdRefillPolicy checks balances and taps sources.</li> <li>Retirement\u2011age gating prevents early withdrawals.</li> <li>Emergency liquidation if Cash &lt; threshold.</li> </ul> </li> <li> <p>Apply Market Returns</p> <ul> <li>MarketGains samples inflation\u2011adjusted returns.</li> <li>Asset classes update bucket balances.</li> </ul> </li> <li> <p>Tax Collection Drip</p> <ul> <li>Monthly withholding moves funds into Tax Collection bucket.</li> </ul> </li> <li> <p>Snapshot Balances</p> <ul> <li>Records bucket balances and flow logs for audit clarity.</li> </ul> </li> <li> <p>Year\u2011End Settlement (January)</p> <ul> <li>Applies ordinary income, capital gains, and penalty taxes.</li> <li>Withdraws taxes from Cash; refills if negative.</li> <li>Rolls forward estimates into next year.</li> </ul> </li> </ol>"},{"location":"simulation_logic/#trial-execution","title":"\ud83c\udfb2 Trial Execution","text":"<ol> <li> <p><code>run_one_trial()</code></p> <ul> <li>Seeds RNG with trial index.</li> <li>Calls <code>stage_init_components()</code> to build buckets, policies, inflation, tax calculator, and transactions.</li> <li>Wires <code>FlowTracker</code> into all buckets for audit clarity.</li> <li>Runs <code>ForecastEngine</code> with monthly loop.</li> <li>Returns <code>(forecast_df, taxes_df, monthly_returns_df, flow_df)</code>.</li> </ul> </li> <li> <p><code>run_simulation()</code></p> <ul> <li>Wrapper around <code>run_one_trial</code>.</li> <li>Injects trial index into results.</li> <li>Returns <code>(trial, forecast_df, taxes_df, monthly_returns_df, flow_df)</code>.</li> </ul> </li> <li> <p>Parallel Execution</p> <ul> <li>Trials are executed in parallel using <code>ProcessPoolExecutor</code>.</li> <li>Results aggregated into dictionaries keyed by trial index.</li> </ul> </li> </ol>"},{"location":"simulation_logic/#aggregation-phase","title":"\ud83d\udcca Aggregation Phase","text":"<p>After all trials complete:</p> <ul> <li>Net Worth DataFrame (<code>mc_networth_df</code>) \u2192 rows = months, columns = trials.</li> <li>Tax DataFrame (<code>mc_tax_df</code>) \u2192 multi\u2011indexed by trial and year.</li> <li>Taxable Balances (<code>mc_taxable_df</code>) \u2192 balances at SEPP end month.</li> <li>Monthly Returns (<code>mc_monthly_returns_df</code>) \u2192 consolidated across trials.</li> <li>Summary Tracking \u2192 property liquidation events and taxable balances logged for audit clarity.</li> </ul>"},{"location":"simulation_logic/#visualization-integration","title":"\ud83d\udcc8 Visualization Integration","text":"<p>The aggregated results feed into the visualization layer:</p> <ul> <li>Historical Charts \u2192 bucket gains, net worth trajectory.</li> <li>Per\u2011Trial Charts \u2192 monthly expenses, transactions, taxes, forecasts.</li> <li>Aggregate Monte Carlo Charts \u2192 monthly returns, taxable balances, totals/rates, net worth distribution.</li> <li>All charts are exportable to HTML and CSV with timestamped filenames.</li> </ul>"},{"location":"simulation_logic/#forecastengine-audit-notes","title":"\ud83d\udcdd ForecastEngine Audit Notes","text":"<ul> <li>ForecastEngine orchestrates monthly simulation flows, integrating buckets, transactions, market gains, refills, liquidations, and taxes.</li> <li>All results are auditable via structured records: monthly snapshots, tax logs, and return records.</li> <li>Tax inputs (salary, unemployment, Social Security, withdrawals, gains, penalties, etc.) are consistently aggregated through structured getters.</li> <li>Yearly tax logs ensure reproducibility of IRS\u2011aligned categories (ordinary income, capital gains, Social Security, Roth conversions, penalties).</li> <li>Tax estimation and withholding logic provide ongoing audit clarity, spreading liabilities across months and reconciling at year\u2011end.</li> <li>SEPP withdrawals, marketplace premiums, and IRMAA surcharges are applied in compliance with IRS and SSA rules.</li> <li>Roth conversion logic enforces policy\u2011driven thresholds (age cutoffs, source balances, max tax rates) and calculates headroom before applying conversions.</li> <li>Year\u2011end reconciliation finalizes Roth conversions, computes tax liabilities, and records withdrawal rates and portfolio values.</li> <li>Monthly snapshots preserve bucket balances for downstream visualization and audit.</li> </ul> <p>Specialized audit notes:</p> <ul> <li>SEPP logic: IRS amortization method ensures penalty\u2011exempt withdrawals.</li> <li>Marketplace premiums: capped at 8.5% of prior MAGI, withdrawn from Cash.</li> <li>IRMAA premiums: surcharge brackets applied based on prior MAGI, doubled for MFJ.</li> <li>Roth conversions: ordinary income withdrawals, penalty\u2011exempt, applied only within configured headroom.</li> <li>Year\u2011end reconciliation: ensures taxes are paid from Tax Collection first, then Cash, with leftover handling logged.</li> </ul>"},{"location":"simulation_logic/#related-pages","title":"\ud83d\udcda Related Pages","text":"<ul> <li>Architecture Overview \u2192 system design and modular components</li> <li>Configuration Reference \u2192 JSON and CSV inputs</li> <li>Visualization Guide \u2192 charts and exports</li> <li>Usage Guide \u2192 workflow and output files</li> </ul>"},{"location":"usage/","title":"\ud83d\ude80 Usage Guide","text":"<p>This guide explains how to run Nomad Wealth simulations, control output behavior, and interpret results.</p>"},{"location":"usage/#running-the-simulation","title":"\u25b6\ufe0f Running the Simulation","text":"<ol> <li> <p>Navigate to the project root    Ensure you are in the directory containing <code>src/app.py</code>.</p> </li> <li> <p>Run the entry point</p> </li> </ol> <p><code>bash    python src/app.py</code></p> <p>This executes the <code>main()</code> method, which:</p> <ul> <li>Loads JSON and CSV configuration files.</li> <li>Prepares historical and future timeframes.</li> <li>Runs Monte Carlo trials via <code>forecast_engine.py</code> in parallel.</li> <li>Aggregates results into DataFrames.</li> <li> <p>Generates interactive charts and CSV/HTML exports.</p> </li> <li> <p>Check the <code>export/</code> directory    All outputs (HTML charts, CSVs) are saved here with timestamped filenames.</p> </li> </ul>"},{"location":"usage/#controlling-behavior","title":"\u2699\ufe0f Controlling Behavior","text":"<p>Simulation behavior is controlled by flags in <code>app.py</code>:</p> <ol> <li> <p>Simulation Size</p> <ul> <li><code>SIM_SIZE</code> \u2192 number of Monte Carlo trials.</li> </ul> </li> <li> <p>Chart Display</p> <ul> <li><code>SHOW_*</code> flags \u2192 control whether charts open interactively.</li> <li>Examples: <code>SHOW_NETWORTH_CHART</code>, <code>SHOW_EXAMPLES</code>, <code>SHOW_HISTORICAL</code>.</li> </ul> </li> <li> <p>Chart Export</p> <ul> <li><code>SAVE_*</code> flags \u2192 control whether charts are saved to HTML/CSV.</li> <li>Examples: <code>SAVE_NETWORTH_CHART</code>, <code>SAVE_EXAMPLE_TRANSACTIONS_CHART</code>.</li> </ul> </li> <li> <p>Detailed Mode</p> <ul> <li><code>DETAILED_MODE</code> \u2192 overrides show/save flags to ensure all charts and exports are generated for IRS\u2011aligned audit clarity.</li> </ul> </li> <li> <p>Example Trials</p> <ul> <li><code>sim_examples</code> \u2192 number of random trials selected for which detailed charts are generated (expenses, transactions, taxes, forecasts).</li> </ul> </li> </ol>"},{"location":"usage/#inputs-required","title":"\ud83d\udcc2 Inputs Required","text":"<ul> <li>profile.json \u2192 simulation horizon and MAGI.</li> <li>buckets.json \u2192 account definitions (must align with <code>balance.csv</code>).</li> <li>balance.csv \u2192 seed balances.</li> <li>policies.json \u2192 refill, liquidation, salary, SEPP, property, unemployment, Roth conversions.</li> <li>tax_brackets.json \u2192 federal, state, payroll, capital gains, IRMAA, Medicare premiums.</li> <li>inflation_rates.json \u2192 baseline inflation + category profiles.</li> <li>inflation_thresholds.json + gain_table.json \u2192 asset class return regimes.</li> <li>marketplace_premiums.json \u2192 healthcare premiums.</li> <li>fixed.csv \u2192 one\u2011time events (e.g., tuition, travel).</li> <li>recurring.csv \u2192 ongoing monthly flows (e.g., insurance, food, utilities).</li> </ul> <p>All inputs must conform to schemas in Configuration Reference.</p>"},{"location":"usage/#outputs","title":"\ud83d\udcc8 Outputs","text":"<p>Nomad Wealth produces:</p> <ol> <li> <p>Historical Charts</p> <ul> <li><code>plot_historical_bucket_gains()</code> \u2192 bucket-level gain/loss trends.</li> <li><code>plot_historical_balance()</code> \u2192 net worth trajectory + gain/loss bars.</li> </ul> </li> <li> <p>Per-Trial Example Charts (for trials in <code>sim_examples</code>)</p> <ul> <li>Monthly expenses, transactions, transactions in context, income taxes, forecasts.</li> </ul> </li> <li> <p>Aggregate Monte Carlo Charts</p> <ul> <li>Monthly returns distribution.</li> <li>Taxable balances at SEPP end month.</li> <li>Total taxes, effective rates, withdrawal rates.</li> <li>Net worth distribution with median and percentile bands.</li> </ul> </li> <li> <p>CSV Exports</p> <ul> <li>Bucket balances, tax breakdowns, monthly returns, flow logs (debits/credits for audit reproducibility).</li> </ul> </li> </ol>"},{"location":"usage/#notes","title":"\ud83e\uddfe Notes","text":"<ul> <li>Timestamps in filenames use format <code>YYYYMMDD_HHMMSS</code>.</li> <li>Net worth = sum of all bucket balances at each month.</li> <li>SEPP gating enforces IRS 72(t) rules for tax-deferred withdrawals.</li> <li>Roth conversions are modeled independently and may occur before age 59.5.</li> <li>Logging records export paths for traceability.</li> <li>Detailed Mode ensures IRS-aligned audit reproducibility across all charts and exports.</li> </ul>"},{"location":"usage/#related-pages","title":"\ud83d\udcda Related Pages","text":"<ul> <li>Framework Overview \u2192 conceptual landing page</li> <li>Configuration Reference \u2192 JSON and CSV schemas</li> <li>Architecture Overview \u2192 modular system design</li> <li>Simulation Logic \u2192 monthly forecast loop and aggregation</li> <li>Visualization Guide \u2192 charts and exports</li> </ul>"},{"location":"visualization/","title":"\ud83d\udcca Visualization Guide","text":"<p>Nomad Wealth includes a visualization layer that generates interactive Plotly charts and CSV exports. These charts provide transparency, audit clarity, and intuitive insight into both historical data and Monte Carlo simulations.</p>"},{"location":"visualization/#historical-charts","title":"\ud83d\udcdc Historical Charts","text":""},{"location":"visualization/#plot_historical_bucket_gains","title":"<code>plot_historical_bucket_gains()</code>","text":"<ul> <li>Purpose: Shows monthly gain/loss trends for each bucket.</li> <li>Why it matters: Highlights which asset classes contributed to net worth changes over time.</li> </ul>"},{"location":"visualization/#plot_historical_balance","title":"<code>plot_historical_balance()</code>","text":"<ul> <li>Purpose: Net worth line chart + gain/loss bar chart.</li> <li>Why it matters: Provides a clear view of overall net worth trajectory and periods of increase/decrease.</li> </ul>"},{"location":"visualization/#example-trial-charts","title":"\ud83e\uddfe Example Trial Charts","text":"<p>Generated only for trials listed in <code>sim_examples</code>.</p>"},{"location":"visualization/#plot_example_monthly_expenses","title":"<code>plot_example_monthly_expenses()</code>","text":"<ul> <li>Purpose: Visualizes monthly expense flows for a sample simulation.</li> <li>Why it matters: Helps identify spending patterns and stress points.</li> </ul>"},{"location":"visualization/#plot_example_transactions","title":"<code>plot_example_transactions()</code>","text":"<ul> <li>Purpose: Shows transactions for a given year in a sample simulation.</li> <li>Why it matters: Useful for tracing specific flows and verifying transaction logic.</li> </ul>"},{"location":"visualization/#plot_example_transactions_in_context","title":"<code>plot_example_transactions_in_context()</code>","text":"<ul> <li>Purpose: Displays transactions alongside bucket balances.</li> <li>Why it matters: Provides context for how transactions affect overall balances.</li> </ul>"},{"location":"visualization/#plot_example_income_taxes","title":"<code>plot_example_income_taxes()</code>","text":"<ul> <li>Purpose: Annual tax breakdown for a sample simulation.</li> <li>Why it matters: Clarifies how income, withdrawals, and gains translate into tax liabilities.</li> </ul>"},{"location":"visualization/#plot_example_forecast","title":"<code>plot_example_forecast()</code>","text":"<ul> <li>Purpose: Forecasted bucket balances over time for a sample simulation.</li> <li>Why it matters: Shows long\u2011term sustainability of asset allocations.</li> </ul>"},{"location":"visualization/#monte-carlo-charts","title":"\ud83c\udfb2 Monte Carlo Charts","text":"<p>Generated across all trials.</p>"},{"location":"visualization/#plot_mc_monthly_returns","title":"<code>plot_mc_monthly_returns()</code>","text":"<ul> <li>Purpose: Distribution of monthly returns across simulations.</li> <li>Why it matters: Quantifies volatility and return variability.</li> </ul>"},{"location":"visualization/#plot_mc_taxable_balances","title":"<code>plot_mc_taxable_balances()</code>","text":"<ul> <li>Purpose: Taxable balances at SEPP end month.</li> <li>Why it matters: Surfaces liquidity available in taxable accounts at critical milestones.</li> </ul>"},{"location":"visualization/#plot_mc_totals_and_rates","title":"<code>plot_mc_totals_and_rates()</code>","text":"<ul> <li>Purpose: Total taxes, effective tax rates, and withdrawal rates across simulations.</li> <li>Why it matters: Provides audit clarity on tax burden and withdrawal sustainability.</li> </ul>"},{"location":"visualization/#plot_mc_networth","title":"<code>plot_mc_networth()</code>","text":"<ul> <li>Purpose: Net worth distribution with median trajectory and 15th/85th percentile bands.</li> <li>Why it matters: Summarizes overall financial sufficiency and risk bounds.</li> </ul>"},{"location":"visualization/#flags-modes","title":"\u2699\ufe0f Flags &amp; Modes","text":"<ul> <li><code>SHOW_*</code> flags \u2192 control whether charts are displayed interactively.</li> <li><code>SAVE_*</code> flags \u2192 control whether charts are exported to HTML/CSV.</li> <li><code>DETAILED_MODE</code> \u2192 overrides show/save behavior for full audit clarity.</li> </ul>"},{"location":"visualization/#visualization-audit-notes","title":"\ud83d\udcdd Visualization Audit Notes","text":"<ul> <li>Visualization helpers ensure consistent labeling, coloring, and axis formatting across all charts.</li> <li>Percentile overlays (p15, median, p85) provide clear scenario comparison and reproducibility across trials.</li> <li>Dual y\u2011axes allow simultaneous display of dollar values and percentage rates where relevant.</li> <li>Month coercion ensures reproducibility in CSV and HTML outputs.</li> <li>All charts are designed for audit clarity, with explicit labels, hover text, and reference lines.</li> <li>CSV/HTML exports preserve both tabular and interactive views, ensuring reproducibility and presentation quality.</li> <li>Logging records export paths for traceability.</li> </ul> <p>Specialized chart notes:</p> <ul> <li>Sankey diagrams: visualize net flows between buckets, normalize gains/losses, order nodes by volume, and use color coding to distinguish deposits, withdrawals, transfers, gains, and losses. Sliders allow year\u2011by\u2011year inspection.</li> <li>Transactions in context: align flows with year\u2011end balances for audit clarity.</li> <li>Forecast charts: provide bucket\u2011level visibility, net worth trajectory, and age overlays for interpretability.</li> <li>Historical charts: deliver retrospective audit clarity of net worth and bucket\u2011level performance.</li> <li>Monte Carlo charts: visualize distributions of returns, net worth, taxes, withdrawals, and taxable balances across scenarios and trials.</li> <li>Net worth charts highlight probabilistic retirement outcomes, example trials, age metrics, and property liquidation statistics.</li> <li>Totals and rates charts show distributional clarity of tax burdens and withdrawal rates.</li> <li>Taxable balance charts highlight sustainability of taxable accounts at critical milestones (e.g., SEPP end).</li> <li>Scenario color coding (green/red for gains/losses, scenario colors for returns) ensures interpretability.</li> <li>Highlighted trials allow auditors to trace specific scenarios.</li> </ul>"},{"location":"visualization/#related-pages","title":"\ud83d\udcda Related Pages","text":"<ul> <li>Usage Guide \u2192 explains workflow and output files</li> <li>Architecture Overview \u2192 system design and visualization integration</li> <li>Simulation Logic \u2192 monthly loop and aggregation steps</li> </ul>"}]}